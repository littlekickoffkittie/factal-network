version: '3.8'

services:
  fractalchain:
    build: .
    container_name: fractalchain-node
    ports:
      - "8333:8333"  # P2P
      - "8545:8545"  # RPC API
      - "8080:8080"  # Web Explorer
    volumes:
      - fractalchain-data:/root/.fractalchain
      - ./fractalchain.conf:/app/fractalchain.conf
    environment:
      - NETWORK_TYPE=mainnet
    restart: unless-stopped
    command: python3 main.py

  fractalchain-miner:
    build: .
    container_name: fractalchain-miner
    depends_on:
      - fractalchain
    volumes:
      - fractalchain-miner-data:/root/.fractalchain
      - ./fractalchain.conf:/app/fractalchain.conf
    environment:
      - NETWORK_TYPE=mainnet
    restart: unless-stopped
    command: python3 main.py --mine --port 8334

volumes:
  fractalchain-data:
  fractalchain-miner-data:
